<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../css/structure.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script type="text/javascript" src="../js/jquery-3.1.0.min.js"></script>
    <script>
        $.ajax({
            type: "POST",
            data: {
                "accion": "obtenerPaises"
            },
            url: "crudPoblaciones.php",
            success: function (data) {
                var respuesta = JSON.parse(data);
                createOption(respuesta.paises);
            }
        });
    </script>
    <style>
        html,
        body,
        header {
            width: 100%;
            background-color: black;
            color: white;
        }

        header {
            text-align: center;
            height: 15%;
            margin-top: 3%;
            margin-bottom: 3%;
            font-size: 4em;
        }

        #butCreate {
            float: right;
        }
        #modalInfo{
            display: none;
        }
    </style>
</head>

<body>
    <header>Práctica Acceso15</header>
    <main>
    
            <div class="modal-dialog" role="document" id="modalInfo">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Informacion</h3>
                    </div>
                    <div class="modal-body">
                        <p id="txtInfo">Error al introducir</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-warning" onclick=toggleForm()>Atrás</button></div>
                </div>
            </div>
        
        <div class="container" id="divFormu">
            <div class="container" id="idCreate">
                <form>
                    <div class="form-group row">
                        <label for="paises" class="col-sm-2 col-form-label col-form-label-lg">Paises</label>
                        <div class="col-sm-2">
                            <select class="form-control form-control-lg" id="pais">
                        </select>
                        </div>
                        <label for="poblacion" class="col-sm-2 col-form-label col-form-label-lg">Poblacion</label>
                        <div class="col-sm-2">
                            <input type="number" class="form-control form-control-lg" id="poblacion" placeholder="100000">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="lugar" class="col-sm-2 col-form-label col-form-label-lg">Lugar</label>
                        <div class="col-sm-2">
                            <input type="text" class="form-control form-control-lg" id="lugar" placeholder="Villanueva del trabuco">
                        </div>
                        <label for="latitud" class="col-sm-2 col-form-label col-form-label-lg">Latitud</label>
                        <div class="col-sm-2">
                            <input type="text" class="form-control form-control-lg" id="latitud" placeholder="36">
                        </div>
                        <label for="longitud" class="col-sm-2 col-form-label col-form-label-lg">Longitud</label>
                        <div class="col-sm-2">
                            <input type="text" class="form-control form-control-lg" id="longitud" placeholder="36">
                        </div>
                    </div>
                    <div class="form-group row">
                        <button type="button" class="btn btn-warning" id="butCreate" onclick="createPoblacion()">Crear</button>
                    </div>
                </form>
            </div>

            <div class="container" id="idFind">
                <form>
                    <div class="form-group row">
                        <label for="fpaises" class="col-sm-2 col-form-label col-form-label-lg">Paises</label>
                        <div class="col-sm-2">
                            <select class="form-control form-control-lg" onfocus="findPoblacion()" id="fpaises">
                                    <option>Large select</option>
                                </select>
                        </div>
                        <label for="flugar" class="col-sm-2 col-form-label col-form-label-lg">Lugar</label>
                        <div class="col-sm-2">
                            <input type="text" class="form-control form-control-lg" id="flugar" placeholder="Villanueva del trabuco" onfocus="findPoblacion()">
                        </div>
                        <label for="fpoblacion" class="col-sm-2 col-form-label col-form-label-lg">Poblacion</label>
                        <div class="col-sm-2">
                            <input type="number" class="form-control form-control-lg" id="fpoblacion" placeholder="100000" onfocus="findPoblacion()">
                        </div>
                    </div>
                </form>
            </div>
            <div class="container" id="divDatos">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Lugar</th>
                            <th>Pais</th>
                            <th>Poblacion</th>
                            <th>Latitud</th>
                            <th>Longitud</th>
                        </tr>
                    </thead>
                    <tbody id="idBodyTable"></tbody>
                </table>
            </div>
        </div>
    </main>

</body>
<script>
    const formu = new Object();

    function createPoblacion() {

        formu.pais = pais.value;
        formu.poblacion = poblacion.value;
        formu.lugar = lugar.value;
        formu.latitud = latitud.value;
        formu.longitud = longitud.value;
        let data = JSON.stringify(formu);
        $.ajax({
            type: "POST",
            data: {
                "accion": "createPoblacion",
                "data": data
            },
            url: "crudPoblaciones.php",
            success: function (data) {
                var respuesta = JSON.parse(data);
                console.log(data);
                clean();
                toggleForm();
            }
        });
    }

    function findPoblacion() {
        formu.pais = fpaises.value;
        formu.lugar = flugar.value;
        formu.poblacion = fpoblacion.value;
        let data = JSON.stringify(formu);
        $.ajax({
            type: "POST",
            data: {
                "accion": "findPoblacion",
                "data": data
            },
            url: "crudPoblaciones.php",
            success: function (data) {
                var respuesta = JSON.parse(data);
                console.log(data);
                clean();
            }
        });
    }

    function clean() {
        formu.pais = "";
        formu.poblacion = "";
        formu.lugar = "";
        formu.latitud = "";
        formu.longitud = "";
    }

    function toggleForm() {
        if ($("#divFormu").is(':visible')) {
            console.log("gola")
            $("#divFormu").hide('slow');
            $("#modalInfo").css('display','block');
        } else {
            $("#divFormu").show('slow');
            $("#modalInfo").css('display','none');
        }
    }
    function createOption(data){
        html="";
        for(let i=0;i<data.length;i++){
            html+='<option value='+data[i]+'>'+data[i]+'</option>';
        }
        $("#pais").html(html);
        
    }
    /*
    ALTER TABLE LUGARES PARTITION BY RANGE(ASCII(substring(pais,1,1)))(
        partition pA values less than (ASCII(66)),
        partition pB values less than (ASCII(67)),
        partition pC values less than (ASCII(68)),
        partition pD values less than (ASCII(69)),
        partition pE values less than (ASCII(70)),
        partition pF values less than (ASCII(71)),
        partition pG values less than (ASCII(72)),
        partition pH values less than (ASCII(73)),
        partition pI values less than (ASCII(74)), 
        partition pJ values less than (ASCII(75)),
        partition pK values less than (ASCII(76)),
        partition pL values less than (ASCII(77)),
        partition pM values less than (ASCII(78)),
        partition pN values less than (ASCII(79)),
        partition pO values less than (ASCII(80)),
        partition pP values less than (ASCII(81)),
        partition pQ values less than (ASCII(82)),
        partition pR values less than (ASCII(83)),
        partition pS values less than (ASCII(84)),
        partition pT values less than (ASCII(85)),
        partition pU values less than (ASCII(86)),
        partition pV values less than (ASCII(87)),
        partition pW values less than (ASCII(88)),
        partition pX values less than (ASCII(89)),
        partition pY values less than (ASCII(90)),
        partition pDefault values less than (ASCII(91))

    )



    */
</script>

</html>